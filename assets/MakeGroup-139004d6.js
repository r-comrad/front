import{r as k,u as y}from"./index-9d1c1e6a.js";import{a as x,b as $}from"./runtime-dom.esm-bundler-c45b8d01.js";import{a as g,U as p}from"./config-ecf8e2cb.js";import{_ as C}from"./StudentsSearch-1e15b31e.js";import{A as S,H as G,G as _,o as u,c,b,a as t,I as v,J as h,r as L,O as M,K as I,L as N,R as O,P as V,y as w}from"./runtime-core.esm-bundler-866dbb67.js";const D={class:"modal fade",id:"group_create",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},U={class:"modal-dialog"},B={class:"modal-content"},J=t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Изменение групп"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),T={class:"modal-body",style:{}},E={class:"mb-3"},P=t("label",{class:"form-label"},"Имя",-1),R=t("div",{class:"mb-3"},[t("button",{class:"btn btn-primary","data-bs-target":"#group_students","data-bs-toggle":"modal"}," Выбрать обучающихся ")],-1),A={class:"modal-footer"},F=["data-bs-target"],H={__name:"GroupModal",props:["group","students","backID"],emits:["ChangeGroup"],setup(d,{emit:i}){const s=d,e=S({name:"",students:[],grade:"",id:""});G(s,()=>{e.name=s.group.name,e.students=s.group.students===void 0?[]:s.group.students,e.grade=s.group.grade,e.id=s.group.id===void 0?0:s.group.id}),_("");const r=a=>{let l=[];if(a)for(let n of a)l.push(n.id);return l},m=a=>{e.students=a},o=()=>{console.log({id:e.id,name:e.name,students:r(e.students),grade:e.grade.id}),g({url:p+"/manage_group",method:"POST",data:{id:e.id,name:e.name,students:r(e.students),grade:e.grade.id},headers:{token:JSON.parse(localStorage.getItem("user")).token}}).then(a=>{k.go()})};return(a,l)=>(u(),c(h,null,[b(C,{students:d.students,selected:r(e.students),"back-i-d":"#group_create",id:"group_students",onMakeList:m},null,8,["students","selected"]),t("div",D,[t("div",U,[t("div",B,[J,t("div",T,[t("div",E,[P,v(t("input",{type:"text",class:"form-control","onUpdate:modelValue":l[0]||(l[0]=n=>e.name=n)},null,512),[[x,e.name]])]),R,t("div",A,[t("button",{type:"button",class:"btn btn-primary","data-bs-target":d.backID,"data-bs-toggle":"modal"}," Назад ",8,F),t("button",{type:"button",class:"btn btn-primary",onClick:o,"data-bs-dismiss":"modal"},"Сохранить")])])])])])],64))}},K={class:"table text-center"},j=t("th",null,"Имя",-1),q=t("th",null,"Изменить",-1),z=["onClick"],Q=t("i",{class:"bi bi-pencil-fill"},null,-1),W=[Q],X=["onUpdate:modelValue"],Y={__name:"GroupList",props:["grade"],setup(d){const i=d,s=_([]);g.get(p+"/all_groups",{headers:{token:JSON.parse(localStorage.getItem("user")).token}}).then(o=>{console.log(o.data),s.value=o.data.groups.filter(a=>a.grade===i.grade.id);for(let a of s.value)a.grade=i.grade;s.value.forEach(a=>{a.to_delete=!1})});const e=_({}),r=o=>{e.value=o},m=()=>{let o=[];s.value.forEach(a=>{a.to_delete&&o.push(a.id)}),g({method:"POST",url:p+"/drop_groups",data:{groups:o}}).then(a=>{k.go()})};return(o,a)=>{const l=L("router-link");return u(),c(h,null,[b(H,{students:d.grade.students,"back-i-d":"#group_manage",group:e.value},null,8,["students","group"]),t("button",{type:"button",class:"btn btn-primary me-3 mt-3","data-bs-target":"#group_create","data-bs-toggle":"modal",onClick:a[0]||(a[0]=n=>r({grade:d.grade}))}," Создать новую группу "),b(l,{to:{name:"grade_management"},class:"btn btn-outline-primary mt-3"},{default:M(()=>[O(" Назад ")]),_:1}),t("table",K,[t("thead",null,[t("tr",null,[j,q,t("th",{style:{width:"10%"}},[t("button",{class:"btn btn-danger btn-sm",onClick:m},"Удалить")])])]),t("tbody",null,[(u(!0),c(h,null,I(s.value,n=>(u(),c("tr",null,[t("td",null,N(n.name),1),t("td",null,[t("button",{class:"btn btn-primary btn-sm",onClick:f=>r(n),"data-bs-target":"#group_create","data-bs-toggle":"modal"},W,8,z)]),t("td",null,[v(t("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":f=>n.to_delete=f},null,8,X),[[$,n.to_delete]])])]))),256))])])],64)}}},ot={__name:"MakeGroup",setup(d){return(i,s)=>(u(),V(Y,{grade:JSON.parse(w(y)().params.grade)},null,8,["grade"]))}};export{ot as default};
