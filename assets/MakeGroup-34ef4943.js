import{r as k}from"./index-c91c4047.js";import{u as y}from"./vue-router-dca7c9af.js";import{a as x,b as $}from"./runtime-dom.esm-bundler-62d8dff8.js";import{a as p,U as g}from"./axios-99647cd3.js";import{_ as S}from"./StudentsSearch-20dd47c0.js";import{A as C,H as M,G as _,o as u,c,b,a as t,J as v,K as h,r as G,P as L,L as N,M as V,S as w,Q as D,y as I}from"./runtime-core.esm-bundler-39f475bb.js";const O={class:"modal fade",id:"group_create",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},U={class:"modal-dialog"},B={class:"modal-content"},J=t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Изменение групп"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),T={class:"modal-body",style:{}},E={class:"mb-3"},P=t("label",{class:"form-label"},"Имя",-1),R=t("div",{class:"mb-3"},[t("button",{class:"btn btn-primary","data-bs-target":"#group_students","data-bs-toggle":"modal"}," Выбрать обучающихся ")],-1),A={class:"modal-footer"},F=["data-bs-target"],H={__name:"GroupModal",props:["group","students","backID"],emits:["ChangeGroup"],setup(d,{emit:i}){const s=d,e=C({name:"",students:[],grade:"",id:""});M(s,()=>{e.name=s.group.name,e.students=s.group.students===void 0?[]:s.group.students,e.grade=s.group.grade,e.id=s.group.id===void 0?0:s.group.id}),_("");const l=a=>{let r=[];if(a)for(let n of a)r.push(n.id);return r},m=a=>{e.students=a},o=()=>{console.log({id:e.id,name:e.name,students:l(e.students),grade:e.grade.id}),p({url:g+"/manage_group",method:"POST",data:{id:e.id,name:e.name,students:l(e.students),grade:e.grade.id},headers:{token:JSON.parse(localStorage.getItem("user")).token}}).then(a=>{k.go()})};return(a,r)=>(u(),c(h,null,[b(S,{students:d.students,selected:l(e.students),"back-i-d":"#group_create",id:"group_students",onMakeList:m},null,8,["students","selected"]),t("div",O,[t("div",U,[t("div",B,[J,t("div",T,[t("div",E,[P,v(t("input",{type:"text",class:"form-control","onUpdate:modelValue":r[0]||(r[0]=n=>e.name=n)},null,512),[[x,e.name]])]),R,t("div",A,[t("button",{type:"button",class:"btn btn-primary","data-bs-target":d.backID,"data-bs-toggle":"modal"}," Назад ",8,F),t("button",{type:"button",class:"btn btn-primary",onClick:o,"data-bs-dismiss":"modal"},"Сохранить")])])])])])],64))}},K={class:"table text-center"},Q=t("th",null,"Имя",-1),j=t("th",null,"Изменить",-1),q=["onClick"],z=t("i",{class:"bi bi-pencil-fill"},null,-1),W=[z],X=["onUpdate:modelValue"],Y={__name:"GroupList",props:["grade"],setup(d){const i=d,s=_([]);p.get(g+"/all_groups",{headers:{token:JSON.parse(localStorage.getItem("user")).token}}).then(o=>{console.log(o.data),s.value=o.data.groups.filter(a=>a.grade===i.grade.id);for(let a of s.value)a.grade=i.grade;s.value.forEach(a=>{a.to_delete=!1})});const e=_({}),l=o=>{e.value=o},m=()=>{let o=[];s.value.forEach(a=>{a.to_delete&&o.push(a.id)}),p({method:"POST",url:g+"/drop_groups",data:{groups:o}}).then(a=>{k.go()})};return(o,a)=>{const r=G("router-link");return u(),c(h,null,[b(H,{students:d.grade.students,"back-i-d":"#group_manage",group:e.value},null,8,["students","group"]),t("button",{type:"button",class:"btn btn-primary me-3 mt-3","data-bs-target":"#group_create","data-bs-toggle":"modal",onClick:a[0]||(a[0]=n=>l({grade:d.grade}))}," Создать новую группу "),b(r,{to:{name:"grade_management"},class:"btn btn-outline-primary mt-3"},{default:L(()=>[w(" Назад ")]),_:1}),t("table",K,[t("thead",null,[t("tr",null,[Q,j,t("th",{style:{width:"10%"}},[t("button",{class:"btn btn-danger btn-sm",onClick:m},"Удалить")])])]),t("tbody",null,[(u(!0),c(h,null,N(s.value,n=>(u(),c("tr",null,[t("td",null,V(n.name),1),t("td",null,[t("button",{class:"btn btn-primary btn-sm",onClick:f=>l(n),"data-bs-target":"#group_create","data-bs-toggle":"modal"},W,8,q)]),t("td",null,[v(t("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":f=>n.to_delete=f},null,8,X),[[$,n.to_delete]])])]))),256))])])],64)}}},nt={__name:"MakeGroup",setup(d){return(i,s)=>(u(),D(Y,{grade:JSON.parse(I(y)().params.grade)},null,8,["grade"]))}};export{nt as default};
